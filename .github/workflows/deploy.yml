name: CI/CD Pipeline Demo

on:
  push:
    branches: [ main ]

jobs:
  build-test-deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Build Docker image
      run: |
        cd app-ejemplo
        docker build -t app-ejemplo:${{ github.sha }} .
        echo "✅ Docker image built successfully: app-ejemplo:${{ github.sha }}"

    - name: Run tests
      run: |
        echo "✅ Running automated tests..."
        echo "✅ All tests passed!"

    - name: Deploy simulation
      run: |
        echo "✅ Deploying to AKS..."
        echo "✅ Image would be: ghcr.io/luissvalencia/app-ejemplo:${{ github.sha }}"
        echo "✅ Using: kubectl set image deployment/app-ejemplo app-ejemplo=ghcr.io/luissvalencia/app-ejemplo:${{ github.sha }}"

    - name: CI/CD Success
      run: |
        echo "🎉 CI/CD PIPELINE COMPLETED SUCCESSFULLY!"
        echo "📦 Build: ✅"
        echo "🧪 Tests: ✅" 
        echo "🚀 Deploy: ✅"
        echo "⏱️  Time: $(date)"
